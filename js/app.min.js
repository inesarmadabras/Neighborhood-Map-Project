"use strict";function initMap(){function e(e){null!==e.getAnimation()?e.setAnimation(null):(e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1500))}var t=document.getElementById("map"),o=new google.maps.Map(t,{zoom:13,styles:[{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}],center:{lat:38.6766764,lng:-9.184167},disableDefaultUI:!0}),a=function(){var e=0;for(e;e<vm.locations.length;e++)vm.infowindow_array[e].close()};vm.panToLocation=function(t){var l=t.title?t.title:t.name,r=t.position?t.position.lat():t.lat,n=t.position?t.position.lng():t.lng;o.panTo({lat:r,lng:n}),a();var i=0;for(i;i<vm.locations.length;i++)vm.locations[i].name===l&&(vm.infowindow_array[i].open(o,vm.location_array[i]),vm.lat(vm.locations[i].lat),vm.lon(vm.locations[i].lng),e(vm.location_array[i]));vm.flickrApi("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=ff61b408f4c2bab0e24583c8a9b96f26&safe_search=1&per_page=10&lat="+vm.lat()+"&lon="+vm.lon()+"&text="+l+"&sort=relevance&format=json&jsoncallback=?"),vm.updateJson()};var l=function(){vm.highlightListItem(this.title),vm.panToLocation(this)},r=function(){vm.updateJson=function(){$.getJSON(vm.flickrApi()).done(function(e){vm.srcs(e)}).fail(function(){$("#error_msg").html('"Error: Flickr data did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show()})};var e=0;for(e;e<vm.locations.length;e++)vm.location_array[e]=new google.maps.Marker({map:o,position:{lat:vm.locations[e].lat,lng:vm.locations[e].lng},title:vm.locations[e].name,type:vm.locations[e].type,animation:google.maps.Animation.DROP}),vm.infowindow_array[e]=new google.maps.InfoWindow({content:'<h1 class="places">'+vm.locations[e].name+"</h1><br><p>"+vm.locations[e].type+'</p><br><img class="images" src= http://maps.googleapis.com/maps/api/streetview?size=200x100&location='+vm.locations[e].lat+","+vm.locations[e].lng+">"}),vm.location_array[e].addListener("click",l)};r()}var ViewModel=function(){var e=this;e.locations=[{name:"Parque da Paz",lat:38.663434,lng:-9.165485,type:"Public Park"},{name:"Miradouro Boca do Vento",lat:38.684681,lng:-9.1588817,type:"Belvedere"},{name:"Casa do Alentejo",lat:38.7158848,lng:-9.1422239,type:"Restaurant"},{name:"Chinês Clandestino",lat:38.7173632,lng:-9.1372341,type:"Restaurant"},{name:"Vegana Burguers",lat:38.732022,lng:-9.1469121,type:"Restaurant"},{name:"Foxtrot",lat:38.713905,lng:-9.1518868,type:"Bar"},{name:"Pensão do Amor",lat:38.7072048,lng:-9.1436212,type:"Bar"},{name:"Caleidoscópio",lat:38.7571159,lng:-9.1546839,type:"Study Spot"}],e.nav=ko.observableArray(e.locations),e.filter=ko.observable(""),e.filteredNav=ko.computed(function(){var t=e.filter().toLowerCase();return t?e.nav().filter(function(e){return e.name.toLowerCase().indexOf(t)>-1||e.name.indexOf(t)>-1}):e.nav()}),e.highlightListItem=function(e){var t;"string"==typeof e?t=e:"object"==typeof e&&(t=e.name);var o=$(".mdl-navigation a:contains("+t+")");$(".mdl-navigation a").removeClass("mdl-navigation__link--current"),$(o).addClass("mdl-navigation__link--current")},e.panToLocation=ko.observable(),e.location_array=ko.observableArray(),e.infowindow_array=ko.observableArray(),e.clickListItem=function(t){e.highlightListItem(t),e.panToLocation(t)},e.lat=ko.observable(38.6766764),e.lon=ko.observable(-9.184167),e.flickrApi=ko.observable("https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=594fb249392c0301ff092bb17a325a16&safe_search=1&per_page=10&lat="+e.lat()+"&lon="+e.lon()+"&format=json&jsoncallback=?"),e.srcs=ko.observableArray(),e.updateJson=ko.observable(),$.getJSON(e.flickrApi()).done(function(t){e.srcs(t)}).fail(function(){$("#error_msg").html('Error: Flickr data did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show()})};if("object"==typeof ko){var vm=new ViewModel;ko.applyBindings(vm)}else $("#error_msg").html('Error: Knockout.js did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show();var map_url="https://maps.googleapis.com/maps/api/js?key=AIzaSyAuZC_cVOM-k0J3DrvKrfBZuc9MH7sfyko";$.getScript(map_url).done(function(){initMap()}).fail(function(){$("#error_msg").html('Error: Map data did not load. Please <a href="'+window.location.href+'">reload</a> to try again.').show()}),$.ajaxSetup({cache:!0});